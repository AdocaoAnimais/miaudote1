create database  IF NOT EXISTS miaudote;

CREATE TABLE IF NOT EXISTS ESTADO
(
    ESTADO_ID INTEGER         NOT NULL PRIMARY KEY AUTO_INCREMENT,
    CODIGO_UF  INTEGER         NOT NULL,
    NOME      VARCHAR(50) NOT NULL,
    UF        CHAR(2)     NOT NULL,
    REGIAO    INTEGER         NOT NULL
);

CREATE TABLE IF NOT EXISTS CIDADE
(
    CIDADE_ID INTEGER          NOT NULL PRIMARY KEY AUTO_INCREMENT,
    CODIGO    INTEGER          NOT NULL,
    NOME      VARCHAR(255) NOT NULL,
    UF        CHAR(2)      NOT NULL
);

CREATE TABLE IF NOT EXISTS BAIRRO (
  BAIRRO_ID 	 BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  CODIGO VARCHAR(10)	  NOT NULL,
  NOME 	 VARCHAR(255) NOT NULL,
  UF	 VARCHAR(2)	  NOT NULL
);

CREATE TABLE IF NOT EXISTS ENDERECO
(
    ENDERECO_ID BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    BAIRRO_ID     BIGINT NOT NULL,
    ESTADO_ID   INTEGER,
    CIDADE_ID   BIGINT NOT NULL,
    FOREIGN KEY (CIDADE_ID) REFERENCES CIDADE (CIDADE_ID),
    FOREIGN KEY (ESTADO_ID) REFERENCES ESTADO (ESTADO_ID),
    FOREIGN KEY (BAIRRO_ID) REFERENCES BAIRRO (BAIRRO_ID)
);

CREATE TABLE IF NOT EXISTS USUARIO
(
    USUARIO_ID       INTEGER      NOT NULL PRIMARY KEY AUTO_INCREMENT,
    USERNAME         VARCHAR(100) NOT NULL,
    NOME             VARCHAR(60)  NOT NULL,
    SOBRENOME        VARCHAR(60)  NOT NULL,
    CPF              VARCHAR(11)  NOT NULL,
    EMAIL            VARCHAR(50)  NOT NULL,
    SENHA            VARCHAR(60)  NOT NULL,
  --  ENDERECO_ID      INTEGER,
    CONTATO          VARCHAR(15),
    PERFIL_ACESSO    CHAR(1),
    FOTO             BLOB,
    DESCRICAO        VARCHAR(240),
    EMAIL_VERIFICADO BOOLEAN DEFAULT FALSE --,
  --  FOREIGN KEY (ENDERECO_ID) REFERENCES ENDERECO (ENDERECO_ID)
);

CREATE TABLE IF NOT EXISTS PET
(
    PET_ID              INTEGER     NOT NULL PRIMARY KEY AUTO_INCREMENT,
    NOME                VARCHAR(50) NOT NULL,
    SEXO                CHAR(1)     NOT NULL,
    IDADE               INTEGER,
    PORTE               CHAR(1),
    CASTRADO            CHAR(1),
    DATA_CADASTRO       DATETIME        NOT NULL DEFAULT CURRENT_TIMESTAMP,
    DESCRICAO           VARCHAR(240),
    FOTO                BLOB,
    USUARIO_CADASTRO_ID INTEGER     NOT NULL,
    FOREIGN KEY (USUARIO_CADASTRO_ID) REFERENCES USUARIO (USUARIO_ID)
);

CREATE TABLE IF NOT EXISTS DOENCA
(
    DOENCA_ID INTEGER     NOT NULL PRIMARY KEY AUTO_INCREMENT,
    PET_ID    INTEGER,
    NOME      VARCHAR(60) NOT NULL,
    DESCRICAO VARCHAR(150),
    FOREIGN KEY (PET_ID) REFERENCES PET (PET_ID)
);

CREATE TABLE IF NOT EXISTS SOLICITACAO_ADOCAO
(
    SOLICITACAO_ADOCAO_ID          INTEGER   NOT NULL PRIMARY KEY AUTO_INCREMENT,
    USER_RESPONSAVEL_ID            INTEGER   NOT NULL,
    USER_ADOTANTE_ID               INTEGER   NOT NULL,
    DATA_SOLICITACAO               DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    DATA_RESPOSTA_USER_ADOTANTE    DATETIME,
    RESPOSTA_USER_ADOTANTE         CHAR(1),
    DATA_RESPOSTA_USER_RESPONSAVEL DATETIME,
    RESPOSTA_USER_RESPONSAVEL      CHAR(1),
    PET_ID                         INTEGER   NOT NULL,
    FOREIGN KEY (PET_ID) REFERENCES PET (PET_ID),
    FOREIGN KEY (USER_ADOTANTE_ID) REFERENCES USUARIO (USUARIO_ID),
    FOREIGN KEY (USER_RESPONSAVEL_ID) REFERENCES USUARIO (USUARIO_ID)
);

CREATE TABLE IF NOT EXISTS ADOCAO
(
    ADOCAO_ID               BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    DATA_INICIO_ADOCAO      DATETIME    NOT NULL DEFAULT CURRENT_TIMESTAMP,
    USER_ADOCAO_ID          BIGINT NOT NULL,
    PET_ADOTADO_ID          BIGINT NOT NULL,
    SOLICITACAO_ADOCAO_ID   BIGINT NOT NULL,
    DATA_FIM_ADOCAO         DATE,
    DATA_FIM_ACOMPANHAMENTO DATETIME   NOT NULL,
    FOREIGN KEY (USER_ADOCAO_ID) REFERENCES USUARIO (USUARIO_ID),
    FOREIGN KEY (PET_ADOTADO_ID) REFERENCES PET (PET_ID),
    FOREIGN KEY (SOLICITACAO_ADOCAO_ID) REFERENCES SOLICITACAO_ADOCAO (SOLICITACAO_ADOCAO_ID)
);

CREATE TABLE IF NOT EXISTS ACOMPANHAMENTO_ADOCAO
(
    ACOMPANHAMENTO_ADOCAO_ID BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    DATA_ACOMPANHAMENTO      DATETIME    NOT NULL DEFAULT CURRENT_TIMESTAMP,
    DESCRICAO                VARCHAR(240),
    FOTO                     BLOB    NOT NULL,
    ADOCAO_ID                BIGINT NOT NULL,
    FOREIGN KEY (ADOCAO_ID) REFERENCES ADOCAO (ADOCAO_ID)
);

CREATE TABLE IF NOT EXISTS LOG
(
    LOG_ID       INTEGER      NOT NULL PRIMARY KEY AUTO_INCREMENT,
    USUARIO_ID   INTEGER,
    USUARIO_NOME INTEGER,
    DATA         DATETIME    NOT NULL DEFAULT CURRENT_TIMESTAMP,
    ACAO         CHAR(1)      NOT NULL,
    DESCRICAO    VARCHAR(500) NOT NULL,
    FOREIGN KEY (USUARIO_ID) REFERENCES USUARIO (USUARIO_ID)
);

CREATE TABLE IF NOT EXISTS DICAS_NOTICIAS
(
    NOTICIA_ID   INTEGER   NOT NULL PRIMARY KEY AUTO_INCREMENT,
    DATA_CRIACAO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CATEGORIA    CHAR(1),
    CONTEUDO     VARCHAR(500)
);